<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>欲望メーカー</title>
  <style>
    body {
      font-family: "Hiragino Kaku Gothic ProN", sans-serif;
      background-color: #1b1b1b;
      color: #eee;
      text-align: center;
      padding: 1rem;
    }
    h1 {
      color: #ff5252;
      font-size: 1.8rem;
      margin-bottom: 1rem;
    }
    input, button {
      font-size: 1rem;
      padding: 0.6rem;
      margin: 0.2rem;
      border: none;
      border-radius: 5px;
    }
    input {
      width: 60%;
      max-width: 300px;
    }
    button {
      background-color: #ff5252;
      color: white;
      cursor: pointer;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap: 4px;
      margin-top: 1.5rem;
    }
    .cell {
      background: #333;
      color: #fff;
      padding: 10px 4px;
      font-size: 0.7rem;
      border-radius: 4px;
      min-height: 36px;
      display: flex;
      justify-content: center;
      align-items: center;
      word-break: break-word;
    }
    #shareBtn {
      display: inline-block;
      margin-top: 1.5rem;
      background: #1da1f2;
      color: white;
      padding: 0.6rem 1rem;
      border-radius: 5px;
      text-decoration: none;
    }
    footer {
      margin-top: 2rem;
      font-size: 0.9rem;
    }
    footer a {
      color: #1da1f2;
      text-decoration: none;
      padding: 0.5rem 1rem;
      border: 1px solid #1da1f2;
      border-radius: 5px;
      display: inline-block;
    }
    @media (max-width: 600px) {
      .cell {
        font-size: 0.6rem;
        padding: 8px 2px;
      }
    }
  </style>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2LM85GJN0L"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-2LM85GJN0L');
  </script>
</head>
<body>
  <h1>欲望メーカー</h1>
  <p>あなたの脳内、何に支配されてる？</p>
  <input type="text" id="nameInput" placeholder="名前を入力して診断" />
  <button onclick="generateDesire()">診断する</button>

  <div id="resultArea"></div>
  <a id="shareBtn" href="#" target="_blank" style="display:none;">Xでシェア</a>

  <footer>
    <p>つくったひと → <a href="https://x.com/kkp_webninja" target="_blank">@kkp_webninja</a></p>
  </footer>

  <script>
    const desires = [
      { type: "金欲", core: "お金", related: ["札束", "稼ぐ", "資産", "投資", "副業", "貯金", "株", "通帳"] },
      { type: "食欲", core: "食べたい", related: ["肉", "寿司", "スイーツ", "焼肉", "ラーメン", "パン", "お菓子", "チョコ"] },
      { type: "性欲", core: "抱きたい", related: ["恋", "キス", "妄想", "甘えたい", "密着", "夜", "魅了", "欲望"] },
      { type: "物欲", core: "欲しいもの", related: ["ブランド", "限定", "セール", "爆買い", "バッグ", "服", "新作", "ガジェット"] },
      { type: "承認欲求", core: "愛されたい", related: ["SNS", "フォロワー", "バズ", "いいね", "注目", "承認", "称賛", "影響力"] },
      { type: "知識欲", core: "知りたい", related: ["情報", "本", "学び", "探求", "好奇心", "勉強", "謎", "研究"] },
      { type: "権力欲", core: "支配したい", related: ["命令", "支配", "権力", "操作", "統治", "服従", "上下関係", "王"] },
      { type: "自由欲", core: "自由になりたい", related: ["旅", "空", "解放", "ひとり時間", "脱出", "冒険", "自由", "逃避"] },
      { type: "癒し欲", core: "癒されたい", related: ["猫", "温泉", "自然", "睡眠", "散歩", "森林", "香り", "やすらぎ"] },
      { type: "健康欲", core: "健康になりたい", related: ["筋トレ", "野菜", "サプリ", "水", "睡眠", "ランニング", "免疫", "体調"] },
      { type: "家族欲", core: "守りたい", related: ["家族", "子供", "妻", "夫", "安定", "信頼", "ぬくもり", "生活"] },
      { type: "創作欲", core: "作りたい", related: ["音楽", "絵", "創造", "表現", "制作", "デザイン", "詩", "舞台"] },
    ];

    const noiseWords = ["ゲーム", "昼寝", "掃除", "カフェ", "散歩", "DIY", "洗濯", "忍者", "動画", "アニメ", "バラエティ", "SNS", "ラジオ"];

    function stringToSeed(str) {
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        hash = (hash << 5) - hash + str.charCodeAt(i);
        hash |= 0;
      }
      return Math.abs(hash);
    }

    function seededShuffle(array, seed) {
      const result = array.slice();
      for (let i = result.length - 1; i > 0; i--) {
        const j = seed % (i + 1);
        [result[i], result[j]] = [result[j], result[i]];
        seed = (seed * 9301 + 49297) % 233280;
      }
      return result;
    }

    function generateDesire() {
      const name = document.getElementById("nameInput").value.trim();
      if (!name) {
        alert("名前を入力してください！");
        return;
      }

      const seed = stringToSeed(name);
      const desire = desires[seed % desires.length];
      const shuffledRelated = seededShuffle(desire.related, seed);
      const shuffledNoise = seededShuffle(noiseWords, seed + 100);

      const grid = Array(81).fill("").map((_, i) => ({
        text: shuffledNoise[i % shuffledNoise.length],
        color: "#444"
      }));

      grid[40] = { text: desire.core, color: "#ff5252" };

      const neighborIndexes = [30,31,32,39,41,48,49,50];
      neighborIndexes.forEach((i, idx) => {
        grid[i] = { text: shuffledRelated[idx % shuffledRelated.length], color: "#2196f3" };
      });

      let html = `<h2>${name}の欲望タイプ：${desire.type}</h2><div class="grid">`;
      grid.forEach(cell => {
        html += `<div class="cell" style="background:${cell.color}">${cell.text}</div>`;
      });
      html += `</div>`;
      document.getElementById("resultArea").innerHTML = html;

      const shareText = encodeURIComponent(`${name}の欲望は「${desire.type}」で埋め尽くされていた…！ #欲望メーカー`);
      const pageUrl = encodeURIComponent(location.href);
      document.getElementById("shareBtn").href = `https://twitter.com/intent/tweet?text=${shareText}&url=${pageUrl}`;
      document.getElementById("shareBtn").style.display = "inline-block";
    }
  </script>
</body>
</html>
