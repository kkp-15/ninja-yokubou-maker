<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>欲望メーカー</title>
  <style>
    body {
      font-family: "Hiragino Kaku Gothic ProN", sans-serif;
      background-color: #1b1b1b;
      color: #eee;
      text-align: center;
      padding: 1rem;
    }
    h1 {
      color: #ff5252;
      font-size: 1.8rem;
      margin-bottom: 1rem;
    }
    input, button {
      font-size: 1rem;
      padding: 0.6rem;
      margin: 0.2rem;
      border: none;
      border-radius: 5px;
    }
    input {
      width: 60%;
      max-width: 300px;
    }
    button {
      background-color: #ff5252;
      color: white;
      cursor: pointer;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap: 4px;
      margin-top: 1.5rem;
    }
    .cell {
      background: #333;
      color: white;
      padding: 10px 4px;
      font-size: 0.7rem;
      border-radius: 4px;
      min-height: 36px;
      display: flex;
      justify-content: center;
      align-items: center;
      word-break: break-word;
    }
    .core { background: #e53935 !important; }
    .main { background: #1e88e5 !important; }
    .sub  { background: #43a047 !important; }

    .outer-border-top    { border-top: 3px solid #fff; }
    .outer-border-bottom { border-bottom: 3px solid #fff; }
    .outer-border-left   { border-left: 3px solid #fff; }
    .outer-border-right  { border-right: 3px solid #fff; }

    #shareBtn {
      display: inline-block;
      margin-top: 1.5rem;
      background: #1da1f2;
      color: white;
      padding: 0.6rem 1rem;
      border-radius: 5px;
      text-decoration: none;
    }
    footer {
      margin-top: 2rem;
    }
    footer a {
      color: #1da1f2;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <h1>欲望メーカー</h1>
  <input type="text" id="nameInput" placeholder="名前を入力して診断" />
  <button onclick="generateDesire()">診断する</button>

  <div id="resultArea"></div>
  <a id="shareBtn" href="#" target="_blank" style="display:none;">Xでシェア</a>

  <footer>
    <p>つくったひと → <a href="https://x.com/kkp_webninja" target="_blank">@kkp_webninja</a></p>
  </footer>

  <script>
    const desires = [
      { type: "癒し欲", core: "癒されたい", related: ["自然", "香り", "温泉", "睡眠", "森林", "やすらぎ", "散歩", "体調"] },
      { type: "承認欲", core: "認められたい", related: ["拍手", "SNS", "注目", "見られたい", "名誉", "賞賛", "フォロワー"] },
      { type: "金欲", core: "お金がほしい", related: ["副業", "高収入", "投資", "宝くじ", "昇給", "節約", "貯金", "資産"] },
      { type: "食欲", core: "食べたい", related: ["スイーツ", "寿司", "ケーキ", "焼肉", "チョコ", "ラーメン", "餃子", "果物"] },
      { type: "支配欲", core: "支配したい", related: ["命令", "権力", "統治", "操作", "支配", "王", "服従", "上下関係"] }
    ];

    const noise = ["ゲーム", "掃除", "カフェ", "ラジオ", "アニメ", "散歩", "DIY", "SNS", "映画", "生活", "子供", "夫", "知恵", "情報", "管理", "デザイン"];

    function hashSeed(str) {
      return str.split('').reduce((s, c) => s + c.charCodeAt(0), 0);
    }

    function generateDesire() {
      const name = document.getElementById("nameInput").value.trim();
      if (!name) return alert("名前を入力してください");

      const seed = hashSeed(name);
      const coreDesire = desires[seed % desires.length];
      const subDesires = desires.filter(d => d !== coreDesire);

      const grid = Array(81).fill(null).map((_, i) => ({ text: noise[(seed + i) % noise.length], class: "" }));

      const centerIndexes = [30,31,32,39,40,41,48,49,50];
      centerIndexes.forEach((idx, i) => {
        grid[idx] = {
          text: i === 4 ? coreDesire.core : coreDesire.related[(seed + i) % coreDesire.related.length],
          class: i === 4 ? "core" : "main"
        };
      });

      const outerBlocks = [
        [0,1,2,9,10,11,18,19,20],
        [3,4,5,12,13,14,21,22,23],
        [6,7,8,15,16,17,24,25,26],
        [27,28,29,36,37,38,45,46,47],
        [33,34,35,42,43,44,51,52,53],
        [54,55,56,63,64,65,72,73,74],
        [57,58,59,66,67,68,75,76,77],
        [60,61,62,69,70,71,78,79,80]
      ];

      outerBlocks.forEach((block, b) => {
        const d = subDesires[(seed + b * 7) % subDesires.length];
        block.forEach((idx, i) => {
          let cls = "";  // ← 外は色を付けない（.subなし）
          if (i < 3) cls += " outer-border-top";
          if (i % 3 === 0) cls += " outer-border-left";
          if (i % 3 === 2) cls += " outer-border-right";
          if (i >= 6) cls += " outer-border-bottom";
          grid[idx] = {
            text: d.related[(seed + idx + i) % d.related.length],
            class: cls
          };
        });
      });

      let html = `<h2>${name}の欲望タイプ：${coreDesire.type}</h2><div class="grid">`;
      grid.forEach(cell => {
        html += `<div class="cell ${cell.class}">${cell.text}</div>`;
      });
      html += `</div>`;
      document.getElementById("resultArea").innerHTML = html;

      const shareText = encodeURIComponent(`${name}の欲望は「${coreDesire.type}」で溢れていた…！ #欲望メーカー`);
      const pageUrl = encodeURIComponent(location.href);
      document.getElementById("shareBtn").href = `https://twitter.com/intent/tweet?text=${shareText}&url=${pageUrl}`;
      document.getElementById("shareBtn").style.display = "inline-block";
    }
  </script>
</body>
</html>
